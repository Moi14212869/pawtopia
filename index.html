<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Pawtopia</title>
<link rel="icon" href="favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="./style/style.css">
<link rel="stylesheet" href="./style/style_an.css">
<link rel="stylesheet" href="./style/style_de.css">
<link rel="stylesheet" href="./style/style_bo.css">
</head>
<body>

<div class="nav">
  <button onclick="showPetPage()">ğŸ¾ Animal</button>
  <button onclick="showPage('shop')">ğŸ›’ Boutique</button>
  <button onclick="showPage('adoption')">ğŸ£ Adoption</button>
  <button onclick="showPage('games')">ğŸ® Jeux</button>
</div>

<!-- ACCUEIL -->
<div id="home" class="page active">
  <div class="card">
    <h1>ğŸŒ Pawtopia</h1>
    <p>Bienvenue dans Pawtopia !</p>
    <button onclick="showPage('adoption')">Adopter un animal</button>
  </div>
</div>

<!-- ADOPTION -->
<div id="adoption" class="page">
  <div class="card">
    <h1>ğŸ£ Adoption</h1>
    <input type="text" id="petNameInput" placeholder="Nom de ton animal"><br><br>
    <button onclick="adopt('dragon')">ğŸ‰ Dragon</button>
    <button onclick="adopt('cat')">ğŸ± Chat</button>
    <button onclick="adopt('blob')">ğŸ‘¾ Blob</button>
  </div>
</div>

<!-- ANIMAL -->
<div id="pet" class="page">
  <div class="card">
    <h1>ğŸ¾ Mon Animal</h1>
    <div style="font-size:70px;" id="petImage"></div>
    <h2 id="name"></h2>

    <p>â­ Niveau: <span id="level"></span></p>
    <p>ğŸ’° PiÃ¨ces communes: <span id="coins"></span></p>

    <p>ğŸ Faim</p>
    <div class="bar"><div id="hungerBar" class="fill"></div></div>

    <p>ğŸ˜Š Bonheur</p>
    <div class="bar"><div id="happyBar" class="fill"></div></div>

    <button onclick="feed()">Nourrir (-1ğŸ’°)</button>

    <h3>ğŸ“‹ Mes animaux</h3>
    <div id="petList"></div>
  </div>
</div>

<!-- BOUTIQUE -->
<div id="shop" class="page">
  <div class="card">
    <h1>ğŸ›’ Boutique</h1>
    <p>ğŸ’° PiÃ¨ces communes: <span id="shopCoins"></span></p>
    <button onclick="buyFood()">Acheter nourriture (10ğŸ’°)</button>
  </div>
</div>
<div id="games" class="page">
  <div class="card">
    <h1>ğŸ® Jeux</h1>
    <p>Choisis un mini-jeu :</p>

    <button onclick="showPage('demineur'); initGame();">ğŸ’£ Mini DÃ©mineur</button>
    <button onclick="showPage('avoidGame'); initAvoidGame();">ğŸƒ Ã‰vite les boules</button>
  </div>
</div>
<!-- PAGE DEMINEUR -->
<div id="demineur" class="page">
  <div class="card">
    <h1>ğŸ’£ Mini DÃ©mineur</h1>

    <div id="board"></div>
    <p id="message"></p>

    <button onclick="initGame()">Rejouer</button>
    <button onclick="showPage('games')">â¬… Retour aux jeux</button>

    <p>Clic gauche = rÃ©vÃ©ler | Clic droit = ğŸš©</p>
  </div>
</div>
  <!-- Ã‰VITE LES BOULES -->
<div id="avoidGame" class="page">
  <div class="card" style="padding:0; background:none; box-shadow:none;">
    <h1 style="color:white;">ğŸƒ Ã‰vite les boules !</h1>
    <canvas id="gameCanvas" width="800" height="500"></canvas>
    <div id="score" style="position:relative; top:10px; left:10px; color:white;">Score : 0</div>
    <div id="gameOver" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); color:white; font-size:40px; display:none; text-align:center;">
      GAME OVER<br>Recharge la page
    </div>
    <button onclick="showPage('games')" style="margin-top:10px; background:#4CAF50; color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer;">
      â¬… Retour aux jeux
    </button>
  </div>
</div>
<script src="script/script.js"></script>
<script src="script/script_de.js"></script>
<script>
function initAvoidGame(){
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const gameOverText = document.getElementById("gameOver");

  let mouseX = canvas.width / 2;
  let mouseY = canvas.height / 2;

  let enemies = [];
  let bonuses = [];
  let score = 0;
  let gameRunning = true;
  let shieldActive = false;

  canvas.addEventListener("mousemove", (e) => {
      const rect = canvas.getBoundingClientRect();
      mouseX = e.clientX - rect.left;
      mouseY = e.clientY - rect.top;
  });

  function spawnEnemy() {
      if (!gameRunning) return;

      enemies.push({
          x: -30,
          y: Math.random() * canvas.height,
          radius: 15,
          speed: 3 + Math.random() * 3,
          color: `hsl(${Math.random()*360}, 80%, 50%)` // couleurs vives alÃ©atoires
      });

      if (Math.random() < 0.1) {
          bonuses.push({
              x: -30,
              y: Math.random() * canvas.height,
              radius: 12,
              speed: 2 + Math.random() * 2
          });
      }
  }

  function checkCollisionCircle(aX, aY, aR, bX, bY, bR) {
      const dx = aX - bX;
      const dy = aY - bY;
      return Math.sqrt(dx*dx + dy*dy) < aR + bR;
  }

  function handleGameOver() {
      gameRunning = false;
      gameOverText.style.display = "block";

      // RÃ©compenser les pets
      pets.forEach(p => {
          p.happiness = Math.min(100, p.happiness + 15);
      });
      coins += score;
      save(); update();

      setTimeout(() => {
          gameOverText.style.display = "none";
          showPage("games");
      }, 5000);
  }

  function update() {
      if (!gameRunning) return;

      // Fond noir
      ctx.fillStyle = "#000";
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // Afficher score
      ctx.fillStyle = "white";
      ctx.font = "24px Arial";
      ctx.fillText("Score : " + score, 20, 30);

  // Joueur
  ctx.save();
  ctx.beginPath();
  ctx.arc(mouseX, mouseY, 10, 0, Math.PI*2);
  ctx.fillStyle = shieldActive ? "lime" : "cyan";
  ctx.shadowBlur = 20;
  ctx.shadowColor = shieldActive ? "lime" : "cyan";
  ctx.fill();
  ctx.closePath();
  ctx.restore();

  // Ennemis
  for(let i=enemies.length-1;i>=0;i--){
      const e = enemies[i];
      e.x += e.speed;

      if(checkCollisionCircle(mouseX, mouseY,10,e.x,e.y,e.radius)){
          if(shieldActive){ shieldActive=false; enemies.splice(i,1);}
          else{ handleGameOver(); return; }
      }

      ctx.save();
      ctx.beginPath();
      ctx.arc(e.x,e.y,e.radius,0,Math.PI*2);
      ctx.fillStyle = e.color;
      ctx.shadowBlur = 15;
      ctx.shadowColor = e.color;
      ctx.fill();
      ctx.closePath();
      ctx.restore();

      if(e.x - e.radius > canvas.width){ enemies.splice(i,1); score++; }
  }

  // Bonus
  for(let i=bonuses.length-1;i>=0;i--){
      const b = bonuses[i];
      b.x += b.speed;

      if(checkCollisionCircle(mouseX, mouseY,10,b.x,b.y,b.radius)){
          shieldActive = true;
          bonuses.splice(i,1);
      }

      ctx.save();
      ctx.beginPath();
      ctx.arc(b.x,b.y,b.radius,0,Math.PI*2);
      ctx.fillStyle = "lime";
      ctx.shadowBlur = 15;
      ctx.shadowColor = "lime";
      ctx.fill();
      ctx.closePath();
      ctx.restore();

      if(b.x - b.radius > canvas.width) bonuses.splice(i,1);
  }

      requestAnimationFrame(update);
  }

  setInterval(spawnEnemy, 800);
  update();
}
initGame();
</script>

</body>
</html>
